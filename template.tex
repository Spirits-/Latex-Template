%To whoever uses this: If you don't need custom fonts, you don't need xelatex, and if you don't need code highlighting (minted package), you don't need shell escape. 
%DO NOT USE SHELL ESCAPE WITH LATEX PACKAGES YOU DO NOT TRUST.
\documentclass[12pt,a4paper]{article}
    \usepackage{amsmath} %For math and symbols
    \usepackage{amsfonts}
    \usepackage{amssymb}
    \usepackage[margin=2.8cm,headheight=28pt]{geometry} %For paper margins
    \usepackage{fancyhdr} %For headers
    \usepackage{datetime} %For displaying date in headers correctly
    \usepackage{mathspec} %Loads Fontspec too. For changing Fonts and UTF-8 support
    \usepackage{polyglossia} %Languages support
    \setdefaultlanguage{german}
    \usepackage{xcolor} %For colour defining
    \usepackage{minted} %For code blocks
    \usepackage[sf]{titlesec} %For title references like \@title
    \usepackage{graphicx} %For including images
    \usepackage{blindtext} %For testing purposes
    \usepackage[colorlinks=false]{hyperref} %For creating links, in particular for the table of contents
    \usepackage{tocloft} %For modifying table of contents
    \usepackage[defaultlines=4,all]{nowidow} %For avoiding "widows" and "orphans"
    \usepackage{microtype} %Adds micro typing support
    \usepackage{tikz} %For graphical support
    
    \definecolor{background}{HTML}{e7e9db} %For Dark use 2f1e2e
      
    \titleformat{\section}{\LARGE\sffamily\bfseries}{\thesection}{1em}{} %Modifies the section format to be sans serif and bold.
    \titleformat{\subsection}{\Large\sffamily\bfseries}{\thesubsection}{1em}{} %Modifies the subsection format to be sans serif and bold.
    \titleformat{\subsubsection}{\large\sffamily\bfseries}{\thesubsubsection}{1em}{} %Modifies the subsubsection format to be sans serif and bold.
    \titleformat{\paragraph}[runin]{\normalfont\bfseries}{}{}{} %Changes the run-in for paragraphs to bold and main font of the document.
    \titleformat{\subparagraph}[runin]{\normalfont\bfseries}{}{}{} %Changes the run-in for paragraphs to bold and main font of the document.
    
    \renewcommand{\baselinestretch}{1.2} %Controls line spacing.
    
    \renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}} %Adds dotted lines to TOC for sections.

    \renewcommand\theFancyVerbLine{\small\arabic{FancyVerbLine}} %Changes the font size of the line numberings in the minted code environment. 
    \usemintedstyle{paraiso-light} %For Dark use paraiso-dark
    \setminted{
        frame=lines,    
        framesep=2mm,
        baselinestretch=1.2,
        %bgcolor=background, %No bg color = white
        linenos,
        breaklines=true,
        autogobble
    }
    
    \setmainfont{Charis SIL}
    \setsansfont{Helvetica Now Display}
    \setmonofont[Scale=MatchLowercase]{Fira Code Retina}
    \setmathsfont(Digits,Latin){Charis SIL}
    \setmathsfont(Greek){Gentium Plus}

    %Manual replacement of certain symbols in math mode, as XeTeX refuses to use existing symbols from Charis SIL, using Computer Modern glyphs instead. List not exhaustive, added as I encounter them.
    % "0 ordinary; "1 operator; "2 relation, "3 binary operation    
    \Umathcode`+"1 \csname symLatin:m:n\endcsname `+
    \Umathcode`-"1 \csname symLatin:m:n\endcsname `-
    \Umathcode`="2 \csname symLatin:m:n\endcsname `=
    \Umathcode`*"1 \csname symLatin:m:n\endcsname `× \def\times{×}
    \Umathcode`\%"0 \csname symLatin:m:n\endcsname `\%
    \Umathcode`["0 \csname symLatin:m:n\endcsname `[
    \Umathcode`]"0 \csname symLatin:m:n\endcsname `]
    \Umathcode`("0 \csname symLatin:m:n\endcsname `(
    \Umathcode`)"0 \csname symLatin:m:n\endcsname `)
    \Umathcode`."0 \csname symLatin:m:n\endcsname `.
    \Umathcode`,"0 \csname symLatin:m:n\endcsname `,
    
    %Same for Greek alphabet
    \Umathcode`Α"0 \csname symLatin:m:n\endcsname `Α \Umathcode`Β"0 \csname symLatin:m:n\endcsname `Β 
    \Umathcode`Γ"0 \csname symLatin:m:n\endcsname `Γ \Umathcode`Δ"0 \csname symLatin:m:n\endcsname `Δ 
    \Umathcode`Ε"0 \csname symLatin:m:n\endcsname `Ε \Umathcode`Ζ"0 \csname symLatin:m:n\endcsname `Ζ 
    \Umathcode`Η"0 \csname symLatin:m:n\endcsname `Η \Umathcode`Θ"0 \csname symLatin:m:n\endcsname `Θ 
    \Umathcode`Ι"0 \csname symLatin:m:n\endcsname `Ι \Umathcode`Κ"0 \csname symLatin:m:n\endcsname `Κ 
    \Umathcode`Λ"0 \csname symLatin:m:n\endcsname `Λ \Umathcode`Μ"0 \csname symLatin:m:n\endcsname `Μ 
    \Umathcode`Ν"0 \csname symLatin:m:n\endcsname `Ν \Umathcode`Ξ"0 \csname symLatin:m:n\endcsname `Ξ 
    \Umathcode`Ο"0 \csname symLatin:m:n\endcsname `Ο \Umathcode`Π"0 \csname symLatin:m:n\endcsname `Π 
    \Umathcode`Ρ"0 \csname symLatin:m:n\endcsname `Ρ \Umathcode`Σ"0 \csname symLatin:m:n\endcsname `Σ 
    \Umathcode`Τ"0 \csname symLatin:m:n\endcsname `Τ \Umathcode`Υ"0 \csname symLatin:m:n\endcsname `Υ 
    \Umathcode`Φ"0 \csname symLatin:m:n\endcsname `Φ \Umathcode`Χ"0 \csname symLatin:m:n\endcsname `Χ 
    \Umathcode`Ψ"0 \csname symLatin:m:n\endcsname `Ψ \Umathcode`Ω"0 \csname symLatin:m:n\endcsname `Ω 
    \Umathcode`α"0 \csname symLatin:m:n\endcsname `α \Umathcode`β"0 \csname symLatin:m:n\endcsname `β 
    \Umathcode`γ"0 \csname symLatin:m:n\endcsname `γ \Umathcode`δ"0 \csname symLatin:m:n\endcsname `δ 
    \Umathcode`ε"0 \csname symLatin:m:n\endcsname `ε \Umathcode`ζ"0 \csname symLatin:m:n\endcsname `ζ 
    \Umathcode`η"0 \csname symLatin:m:n\endcsname `η \Umathcode`θ"0 \csname symLatin:m:n\endcsname `θ 
    \Umathcode`ι"0 \csname symLatin:m:n\endcsname `ι \Umathcode`κ"0 \csname symLatin:m:n\endcsname `κ 
    \Umathcode`λ"0 \csname symLatin:m:n\endcsname `λ \Umathcode`μ"0 \csname symLatin:m:n\endcsname `μ 
    \Umathcode`ν"0 \csname symLatin:m:n\endcsname `ν \Umathcode`ξ"0 \csname symLatin:m:n\endcsname `ξ 
    \Umathcode`ο"0 \csname symLatin:m:n\endcsname `ο \Umathcode`π"0 \csname symLatin:m:n\endcsname `π 
    \Umathcode`ρ"0 \csname symLatin:m:n\endcsname `ρ \Umathcode`σ"0 \csname symLatin:m:n\endcsname `σ 
    \Umathcode`τ"0 \csname symLatin:m:n\endcsname `τ \Umathcode`υ"0 \csname symLatin:m:n\endcsname `υ 
    \Umathcode`φ"0 \csname symLatin:m:n\endcsname `φ \Umathcode`χ"0 \csname symLatin:m:n\endcsname `χ 
    \Umathcode`ψ"0 \csname symLatin:m:n\endcsname `ψ \Umathcode`ω"0 \csname symLatin:m:n\endcsname `ω      
    
    \makeatletter
    \author{John Doe}\let\Author\@author
    \title{Example document}\let\Title\@title
    \lhead{\Author \\ MAT-NR}
    \rhead{Subject \\ \Title}
    \lfoot{\today}
    \rfoot{\thepage}
    \cfoot{}
    \renewcommand{\headrulewidth}{0pt}
    \pagestyle{fancy}
 
\begin{document}
%\maketitle
%\tableofcontents
%\newpage

\end{document}